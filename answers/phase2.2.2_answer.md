1. 가이드 정보 표시 및 관리
✅ 가이드 목록 테이블 주요 컬럼 (우선순위 기준)
| 구분      | 컬럼                            | 이유                  |
| ------- | ----------------------------- | ------------------- |
| 기본 정보   | 닉네임, 국적, 성별, 등급               | 검색 및 기본 식별 정보       |
| 언어/전문분야 | 태그 형태로 리스트 내 표시               | 시각적으로 명확하며 필터링에 적합  |
| 현재 상태   | 활성/비활성 토글, 예약 중 여부 표시 (배지/색상) | 배정 가능 여부를 즉시 파악 가능  |
| 성과 지표   | 누적 예약 수, 최근 평점(별점), 누적 정산액    | 성과 기반 관리와 신뢰도 판단 가능 |


📌 디자인 포인트:

언어/전문분야는 다중 선택 태그 스타일 (Chip) 사용

예약 중 여부는 색상 아이콘 or 배지 표시 (예: “진행 중”)

성과 지표는 최근 30일 기준도 함께 작은 글씨로 표시하면 유용

2. 가이드 등록/수정 폼
✅ 입력 순서 구성
기본정보 → 언어 능력 → 전문분야 → 추가정보
→ 관리자 UX 기준으로 가장 보편적이고 직관적인 순서

✅ 구성 방식
✅ 한 페이지 내 구성, 단 섹션별 아코디언 또는 구획 분리

관리자 UI는 “빠르게 훑고 수정하는 형태”가 중요

마법사 형식은 불필요하게 클릭이 많아지고, 되돌아가기 불편

✅ 언어 능력 입력 방식
다중 체크박스 + 레벨 입력(선택사항)
예: [✓] 번체 중국어 (상) / [✓] 영어 (중)

드래그앤드롭 우선순위는 필요 없음

✅ 전문분야 선택 방식
다중선택 태그(Chip) 형태 선호
예: 피부과 | 성형외과 | 건강검진

세부 자격/경력 정보 입력은 불필요
→ 대부분 비정형 자료이고 검증 어려움
→ 자격 보유 여부는 관리자 면접 또는 추후 메모로 관리

3. 가이드 가용성 및 스케줄 관리
✅ 스케줄 표시 방식
✅ 주간 캘린더 뷰 (가로 형태 주간 기준)
→ 1일 평균 1~2건 배정되는 구조이므로 주간 단위로 보기가 가장 효율적
→ Flutter TableCalendar 또는 Syncfusion WeekView 등 활용 가능

✅ 휴가/불가능 시간 관리
초기에는 관리자만 설정 가능

가이드는 직접 입력 권한 없이, Slack/문서 등으로 요청 → 관리자가 반영

향후 모바일 앱 도입 시 사용자 직접 설정 기능 도입 검토 가능

✅ 반복 패턴 지원
Phase 2.2에서는 생략
→ 기술 복잡도 높음 + 가이드는 대부분 변동 스케줄이 많음
→ 단일 날짜 휴무 등록부터 시작

4. 가이드 성과 및 평가
✅ 성과 지표 (우선순위)
| 항목          | 필요 여부                 |
| ----------- | --------------------- |
| 누적 예약 수     | ✅ 필요                  |
| 완료율         | ✅ 필요 (취소율 지표로도 활용 가능) |
| 고객 평균 평점    | ✅ 필요                  |
| 월별 누적 정산 금액 | ✅ 필요                  |


📌 월별/분기별 비교는 향후 대시보드 고도화에 반영

✅ 등급 관리
✅ 자동 등급 조정 (정산 누적액 기준)

내부 등급 테이블에 따라 정산 시 자동 계산

관리자 UI에서 ‘현재 등급’ 표기 + override 가능 옵션만 제공

5. 가이드 배정 시스템
✅ 기존 우선순위에 다음 요소 추가 고려:

| 기준 요소            | 적용 여부                                         |
| ---------------- | --------------------------------------------- |
| 언어 매칭            | ✅ 핵심                                          |
| 전문분야 매칭          | ✅                                             |
| 가용성              | ✅                                             |
| **워크로드 균등 분배**   | ✅ **추가 고려** (ex. 동일 일자에 이미 1건 배정된 가이드는 하단 표시) |
| **고객 선호도/이전 매칭** | ⚠️ 추후 구현 고려 (앱 사용시 고객 평가 기반 추천으로 확장 가능)       |


6. 알림 및 커뮤니케이션
✅ 기본 구조는 다음과 같습니다:

| 알림 유형    | 수단                 | 설명                          |
| -------- | ------------------ | --------------------------- |
| 예약 배정/변경 | ✅ 시스템 내 알림 + 이메일   | 가이드 로그인 시 확인 가능, 동시에 이메일 송신 |
| 긴급 일정 변경 | ✅ 이메일 + 수동 전화/톡 대응 | 시스템 내 메시지만으로는 한계            |
| 중요 공지    | ✅ 시스템 내 고정 배너 형태   | 예: 공지사항 섹션에 상단 고정           |


📌 SMS는 국내 발신/외국인 수신에 제약이 있어 현재는 사용하지 않음

| 항목     | 선택안                                     |
| ------ | --------------------------------------- |
| 목록 컬럼  | 닉네임, 국적, 언어(태그), 전문분야(태그), 예약 수, 평점, 상태 |
| 입력 순서  | 기본정보 → 언어 → 전문분야 → 추가정보                 |
| 입력 UI  | 한 페이지, 섹션 구획형                           |
| 언어 입력  | 다중체크 + 레벨 입력                            |
| 전문분야   | 태그형 다중 선택                               |
| 스케줄 보기 | 주간 캘린더 뷰                                |
| 휴가 관리  | 초기에는 관리자만                               |
| 성과 지표  | 예약수, 평점, 정산액, 완료율                       |
| 등급 관리  | 자동 (누적 정산 기준)                           |
| 배정 고려  | 기존 로직 + 워크로드 분산                         |
| 알림 방식  | 시스템 알림 + 이메일                            |


🔧 1. 현재 Phase 2.1 상태 점검
✅ 연동에 오류가 있습니다. 예약 시스템의 CRUD 기능이 동작하지 않습니다. 예약 관리 화면에 다음과 같은 오류 메시지가 나옵니다.

데이터 로드 실패
Exception: 데이터베이스 연결에 문제가 발생했습니다. 잠시 후 다시 시도해 주세요.

🔧 2. 가이드 관리 DB 스키마 보완
✅ 제안된 컬럼 모두 추가가 필요하며, 즉시 반영하겠습니다.

📌 guides 테이블에 추가할 컬럼들:
nickname (TEXT): 사용자와의 친근한 호칭/표시용

profile_image_url (TEXT): 프로필 이미지 표시

is_active (BOOLEAN): 배정 가능 여부를 판단하는 핵심 상태 필드

📌 휴가/불가능 날짜 관리용 테이블
✅ 필요합니다. 아래와 같은 구조로 구성:

sql
CREATE TABLE guide_unavailability (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  guide_id UUID REFERENCES guides(id),
  unavailable_date DATE NOT NULL,
  reason TEXT,
  created_at TIMESTAMP DEFAULT now()
);
향후 반복 패턴, 시간대 관리 필요 시 확장 가능

🔧 3. 파일 업로드 설정
✅ 단계별 전략 적용:

1단계 (MVP) – 임시 URL 방식

가이드 등록 시 직접 URL 입력

UI는 TextFormField + 이미지 미리보기로 구성

예: 클라우드 이미지 URL, Google Drive 링크 등

2단계 (확장) – Supabase Storage 버킷 구성

guide-profile-images 버킷 생성

Flutter File Picker 또는 image_picker → Supabase Storage 업로드 → URL 저장

📌 현재는 1단계로 빠르게 시작, UI 완성 후 파일 업로드 기능 추가가 이상적입니다.

🔧 4. UI 구현 우선순위
✅ 선택: A) 가이드 목록 화면 → 등록/수정 폼 → 상세/성과 화면

이유:

관리자 사용성 측면에서 먼저 목록을 보며 “누구를 추가할지” 판단하는 흐름이 자연스러움

목록과 등록 폼은 동시에 설계/코딩 가능 (MVVM 구조 기준)

상세화면은 성과 기능 정비 이후로도 무방

🔧 5. 기존 예약 시스템과의 연동
✅ 가이드 배정 기능은 예약 시스템에 바로 통합합니다.

이유:

이미 예약 생성 → 가이드 할당 → 상태 전환 구조가 잡혀 있는 상태이며

배정 가능한 가이드를 실시간으로 필터링/선택하는 기능은 가이드 관리 기능과 밀접하게 연관되어 있음

따라서 관리 시스템에서 가이드 등록/수정 → 즉시 예약에 할당 가능하게 설계하는 것이 자연스러움

📌 단, 일정관리(휴무 등) 기반 필터링 로직은 1차 릴리즈 이후 점진적 개선으로 분리

✅ 최종 정리 요약표
| 항목               | 결정 내용                                             |
| ---------------- | ------------------------------------------------- |
| Supabase CRUD 상태 | ✅ 기본 동작 완료                                        |
| guides 테이블 보완    | ✅ `nickname`, `profile_image_url`, `is_active` 추가 |
| 휴무일 테이블          | ✅ 필요, 별도 테이블로 구성                                  |
| 프로필 이미지          | ✅ 1단계는 URL 입력, 2단계는 Storage 업로드 예정                |
| UI 구현 순서         | ✅ A) 목록 → 등록/수정 → 상세                              |
| 예약 시스템과 연동       | ✅ 가이드 관리 완료 전이라도 바로 통합 진행                         |

✅ 공식 답변: 문제 해결 방향
🔧 Q1. 데이터베이스 스키마 수정 vs 코드 수정
선택: A) 데이터베이스를 코드에 맞게 수정

이유:

현재 구조는 실무에 불필요한 다대다 복잡성을 포함하고 있음

예약당 고객 수는 대부분 1~2명이지만, 단일 고객 정보만으로도 전체 흐름 설계가 가능

코드 복잡도, JOIN 성능 문제, 필터링 제한 등에서 스키마 단순화가 훨씬 이득

📌 단, 다고객 기능이 추후 필요해질 수 있으므로 v1은 단일 고객 관계로 구현하고, 확장 여지는 유지

🔧 Q2. 고객-예약 관계 구조
선택: A) 단순화 – 예약당 1명의 주고객만 저장

이유:

실무에서 예약 관리의 90%는 주고객 1명 기준으로 움직임

친구/가족 동반은 부속 정보로 메모로 처리하거나, 추후 additional_guests 형태로 관리 가능

UI, 상태관리, 정산 연동까지 고려하면 단일 고객 관계가 MVP 구현에 가장 적합

📌 데이터베이스 구조 예:

sql
ALTER TABLE reservations
ADD COLUMN customer_id UUID REFERENCES customers(id);
🔧 Q3. 즉시 수정할 우선순위
선택: A) 기본 목록 조회부터 (GET 기능)

이유:

조회 → 확인 → 수정/삭제/생성이라는 자연스러운 흐름을 따라야 효율적인 테스트 가능

목록 조회(리스트 뷰 GET)가 동작해야 전체 UI 테스트, 필터 확인, 성능 체크 가능

CRUD 전체를 한번에 하려면 오류가 겹쳐 디버깅이 어려워짐

📌 즉시 수정 우선순위:

reservations 리스트 조회 쿼리 (고객 이름, 병원명 포함)

ReservationStatus 상태값 → pending, assigned, inProgress, completed, cancelled 식으로 DB 기준에 맞춰 Enum 매핑 재설정

JOIN 테이블명 일치 및 불필요 JOIN 제거

참고할 점점
“우리는 확장 가능한 MVP를 원합니다. 따라서 Phase 2.2 이전에 복잡성을 줄이고, 기본 기능이 안정적으로 작동하는 상태를 먼저 확보하는 것을 최우선으로 하겠습니다. 향후 다고객, Realtime 확장 등은 안정화 이후 적용하겠습니다.”